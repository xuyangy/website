[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Robot Genome",
    "section": "",
    "text": "Robotis and genomics are two of my favorite things. I’m working on a project to combine them."
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "",
    "text": "GDx at OUSAMG is planning to upscale the WGS production to 4 x 48 samples or 2 x 48 + 1 x 96 samples per week. Do we have enough capacity in IT and bioinformatics pipelines for this upscaling?\nThe capacity of IT & bioinformatics pipelines can be evaluated from following three aspects:\n\nData transfer speed\nData storage\nPipeline capacity"
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#data-collection",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#data-collection",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "2.1 Data Collection",
    "text": "2.1 Data Collection\nTo evaluate the data transfer speed from NSC to TSD, we collected the historical data transfer records between 2023-09-01 08:41:40 and 2023-11-30 20:14:10 from the nsc-exporter log.\n\n\n\n\n\n\nexamples of collected data\n\n\n\n\n\n\n\n         [,1]                                     \ndatetime \"2023-10-27 22:46:56\"                    \nproject  \"wgs324\"                                 \nfilename \"Diag-wgs324-HG89805912-DR.alignedMT.bam\"\nbytes    \"29755231\"                               \nseconds  \"0.5\"                                    \nspeed    \"52680000\"                               \n         [,1]                                           \ndatetime \"2023-09-14 17:08:06\"                          \nproject  \"EKG230911\"                                    \nfilename \"CNVdel-KREFT38-KIT-CuCaV3_S39_R1_001.fastq.gz\"\nbytes    \"289260289\"                                    \nseconds  \"3.5\"                                          \nspeed    \"78260000\"                                     \n         [,1]                                            \ndatetime \"2023-11-16 02:20:37\"                           \nproject  \"wgs331\"                                        \nfilename \"Diag-wgs331-HG59386439-DR-Fedme-v1.1.0.cnv.vcf\"\nbytes    \"50995\"                                         \nseconds  \"0\"                                             \nspeed    \"1774690\"                                       \n         [,1]                              \ndatetime \"2023-11-07 10:10:09\"             \nproject  \"EKG231030\"                       \nfilename \"Diag-EKG231030-HG35066736.sample\"\nbytes    \"1555\"                            \nseconds  \"0\"                               \nspeed    \"61270\"                           \n         [,1]                                                                                   \ndatetime \"2023-09-14 17:03:33\"                                                                  \nproject  \"EKG230911\"                                                                            \nfilename \"230913_NDX551382_RUO_0012_AHMWJ7AFX5.NA12878N72c-KREFT38-KIT-CuCaV3_S46_R2_001.qc.pdf\"\nbytes    \"132202\"                                                                               \nseconds  \"0\"                                                                                    \nspeed    \"3380000\"                                                                              \n\n\n\n\n\n\n\n\n\n\n\nThe nsc-exporter log files and the sequencer overview html files were ignored for simplicity. 1"
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#data-overview",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#data-overview",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "2.2 Data Overview",
    "text": "2.2 Data Overview\n\nFile SizeTransfer SpeedTransfer Time\n\n\nThe size of transferred files ranges from 0.0 B to 100.9 GiB. The average file size is 1.5 GiB. The median file size is 9.3 KiB. The standard deviation is 8.1 GiB.\n\n\n\n\n         filesize\nMin.        0.0 B\n1st Qu.   421.0 B\nMedian    9.3 KiB\nMean      1.5 GiB\n3rd Qu. 968.0 KiB\nMax.    100.9 GiB\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe transfer speed ranges from 1.0 B/s to 93.1 MiB/s. The average transfer speed is 12.2 MiB/s. The median transfer speed is 286.7 KiB/s. The standard deviation is 23.4 MiB/s. Transfer speed for small files is usually very low, so the average transfer speed is not a good indicator for actual transfer speed, see Section 2.3.1.\n\n\n\n\n        speed(/s)\nMin.        1.0 B\n1st Qu.  11.9 KiB\nMedian  286.7 KiB\nMean     12.2 MiB\n3rd Qu.   8.4 MiB\nMax.     93.1 MiB\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe transfer time ranges from 0 seconds to 2084.4 seconds. The average transfer time is 19.5 seconds. The median transfer time is 0 seconds. The standard deviation is 104 seconds.\n\n\n\n\n    seconds       \n Min.   :   0.00  \n 1st Qu.:   0.00  \n Median :   0.00  \n Mean   :  19.47  \n 3rd Qu.:   0.10  \n Max.   :2084.40"
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#correlation",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#correlation",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "2.3 Correlation",
    "text": "2.3 Correlation\n\n\n2.3.1 Transfer speed and time VS file size (all files)\nSmall files have lower transfer speed. A good transfer speed around 80 MB/s can be achieved for large files (&gt;2 GB). However, the best speed is observed for files with size around 200 MB (zoom in or see Figure 5).\n\n\n\n\n                        \n                                            \nFigure 1: Transfer speed VS file size (all files)\n\n\n\n\n\n\n\n\nFigure 2: Transfer time VS file size (all files)\n\n\n\n\n\n\n2.3.2 Transfer speed and time VS file size (small files)\nAlthough the transfer speed of small files are very low; the transfer time is usually very short. So small files are not the bottleneck of the data transfer. See also Section 2.5.1.\n\n\n\n\n\nFigure 3: Transfer speed VS file size (small files)\n\n\n\n\n\n\n\n\n\nFigure 4: Transfer time VS file size (small files)\n\n\n\n\n\n\n2.3.3 Maximum transfer reached around 200MB file size?\nSmall files have lower transfer speed. Large files have higher transfer speed. But it looks like best transfer speed is observed for files with sizearound 200 MB file size.\n\n\n\n\n                        \n                                            \nFigure 5: maximum transfer speed reached around 200MB file size"
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#sec-idle-time",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#sec-idle-time",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "2.4 Idle Time",
    "text": "2.4 Idle Time\nTo evaluate whether there is capacity for upscaling, we need to know the idle time of the nsc-exporter. The nsc-exporter is idle when it is not transferring data.\nAll transfer records are plotted with starting time of each transfer on x-axis and the time used to finished the transfer on y-axis. The gaps represnts idle periods of nsc-exporter. The color represents projects, e.g. wgs123, EKG20230901 etc.. The shape represents project type, e.g. wgs, EKG etc. You can turn off a project by clicking it in the legend to the right of the figure.\nFor easier visualization, the data is grouped in months.\n\n2.4.1 September\n\n\n\n\n                        \n                                            \nFigure 6: Transfer time of all files in September\n\n\n\n\n\n\n\n                        \n                                            \nFigure 7: Idle time in September (transfer gaps)\n\n\n\n\n\n\n\n\nFigure 8: Time used for md5sum check in September 2\n\n\n\n\n\n\n\n\n\n\nAttention\n\n\n\n\nTotal absolute time used for transferring files in September is 8 days, 20 hours, 35 minutes and 57.20 seconds. In total 62.9 TB data was transferred including 8 new wgs projects.\nThe nsc-exporter will sleep 10 minutes before checking for new data to transfer. In September, nsc-exporter slept 173 times, totally 1 day, 4 hours and 50 minutes. 3\nAnother type of time used is the md5sum checking by s3cmd put command which is not counted in the absolute transfer time. 4 The total time used for md5sum checking in September is 2 days, 7 hours, 12 minutes and 44.50 seconds.\n\n\n\n\n\n2.4.2 October\n\n\n\n\n                        \n                                            \nFigure 9: Transfer time of all files in October\n\n\n\n\n\n\n\n                        \n                                            \nFigure 10: Idle time in October (transfer gaps)\n\n\n\n\n\n\n\n\nFigure 11: Time used for md5sum check in October\n\n\n\n\n\n\n\n\n\n\nAttention\n\n\n\n\nTotal absolute time used for transferring files in October is 9 days, 16 hours, 5 minutes and 58.40 seconds. In total 71.4 TB data was transferred including 10 new wgs projects.\nThe nsc-exporter will sleep 10 minutes before checking for new data to transfer. In October, nsc-exporter slept 319 times, totally 2 days, 5 hours and 10 minutes.\nThe total time used for md5sum checking in October is 2 days, 14 hours, 50 minutes and 37.70 seconds.\n\n\n\n\n\n2.4.3 November\n\n\n\n\n                        \n                                            \nFigure 12: Transfer time of all files in November\n\n\n\n\n\n\n\n                        \n                                            \nFigure 13: Idle time in November (transfer gaps)\n\n\n\n\n\n\n\n\nFigure 14: Time used for md5sum check in November\n\n\n\n\n\n\n\n\n\n\nAttention\n\n\n\n\nTotal absolute time used for transferring files in November is 11 days, 12 hours, 49 minutes and 45 seconds. In total 83.5 TB data was transferred including 12 new wgs projects.\nThe nsc-exporter will sleep 10 minutes before checking for new data to transfer. In November, nsc-exporter slept 180 times, totally 1 day and 6 hours.\nThe total time used for md5sum checking in November is 3 days, 17 minutes and 58.60 seconds."
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#discussion",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#discussion",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "2.5 Discussion",
    "text": "2.5 Discussion\n\n2.5.1 Do we transfer too many small files?\nFigure 15 show the number of small files and the number of large files using different boundaries. Figure 16 shows that the time used to transfer small files is neglectable.\n\n\n\n\n                        \n                                            \nFigure 15: total number of small files vs large files\n\n\n\n\n\n\n\n                        \n                                            \nFigure 16: total time used for transferring small files\n\n\n\n\n\n\n\n\n\nTotal time (seconds) used to transfer small vs larger files (raw data)\n\n\n\n\n\n\n\n\n\n\nthreshold\nsmall files\nlarge files\n\n\n\n\n1\n&lt;100 kB\n1940\n2595561\n\n\n2\n&lt;1 MB\n4158\n2593343\n\n\n3\n&lt;10 MB\n6746\n2590755\n\n\n4\n&lt;100 MB\n10596\n2586905\n\n\n5\n&lt;1 GB\n38479\n2559021\n\n\n\n\n\n\n\n\n\n2.5.2 Possibility Of An additional 48-sample Run Each Week\n\nThe nsc-exporter is idle for quite a portion of the time Section 2.4.\n\nSeptember’s effective transfer time5 is 12 days, 8 hours, 38 minutes and 41 seconds to transfer 62.9 TB data including that of 8 wgs projects.\nOctober’s effective transfer time is 14 days, 12 hours, 6 minutes and 36 seconds to transfer 71.4 TB data including that of 10 wgs projects.\nNovember’s effective transfer time is 15 days, 19 hours, 7 minutes and 43 seconds to transfer 83.5 TB data including that of 12 wgs projects.\n\nThe maximum transfer speed is reached around 200 MB file size. Figure 5 This interestingly is the configured chunk size of s3cmd which is the tool used by nsc-exporter for data transfer. We might want to increase the chunk size to improve the transfer speed of large files?\nThe current transfer speed is not optimal considering the 10Gbps switch connecting NSC and TSD. We need to investigate the reason for the low transfer speed.\n\n\n\n2.5.3 Calculator\n\n\nmd`Assuming continuous transfer at speed (**MB/s**):`\n\n\n\n\n\n\n\nviewof speed = Inputs.range([1, 500], {value: 80, step: 1})\n\n\n\n\n\n\n\n\n\n\nimport {textcolor} from \"@observablehq/text-color-annotations-in-markdown\"\n\nformatBytes = function formatBytes(bytes,decimals) {\n   if(bytes == 0) return '0 Bytes';\n   var k = 1024,\n       dm = decimals || 2,\n       sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],\n       i = Math.floor(Math.log(bytes) / Math.log(k));\n   return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];\n}\n\nvolume_hour= formatBytes(speed*60*60*1000*1000, 1)\nvolume_day= formatBytes(speed*24*60*60*1000*1000 , 1)\nvolume_week = formatBytes(speed*7*24*60*60*1000*1000, 1)\nvolume_month = formatBytes(speed*30*24*60*60*1000*1000, 1)\nmd`${textcolor(volume_hour, 'MediumSeaGreen')} data can be transferred per **hour**.`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmd`${textcolor(volume_day, 'SlateBlue')} data can be transferred per **day**.`\n\n\n\n\n\n\n\nmd`${textcolor(volume_week, 'Chocolate')} data can be transferred per **week**.`\n\n\n\n\n\n\n\nmd`${textcolor(volume_month, 'Crimson')} data can be transferred per **month**.`"
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#conclusion",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#conclusion",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "2.6 Conclusion",
    "text": "2.6 Conclusion\n\nWe might be able to run 4 x 48 or 2 x 48 + 1 x 96 samples per week. Then we are reaching the limit of the current setup.\nWe need to investigate the reason for the low transfer speed.\nWe need to investigate the possibility of increasing the chunk size of s3cmd to improve the transfer speed.\nWe need to test if running 2 nsc-exporter processes in parallel can improve the transfer capacity."
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#nsc",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#nsc",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "3.1 NSC",
    "text": "3.1 NSC\nOn NSC side, the data is stored in on boston at /boston/diag. Boston has a total capacity of 1.5 PB, and the usable capacity is 1.2 at the moment."
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#tsd",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#tsd",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "3.2 TSD",
    "text": "3.2 TSD\nOn TSD side, the data is stored in /cluster/projects/p22. The total capacity is 1.8 PB, and the usable capacity is 1.2 PB at the moment."
  },
  {
    "objectID": "projects/wgs_upscale/wgs_upscaling_bioinf.html#footnotes",
    "href": "projects/wgs_upscale/wgs_upscaling_bioinf.html#footnotes",
    "title": "WGS Upscaling - IT & Bioinformatics Evaluation",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nThe nsc-exporter log and sequencer overview html files are very small files and do not belong to any projects. They are always transferred in a very short time. They will not affect the transfer speed of other files. Therefore, they are ignored for simplicity.↩︎\nSkipped wgs records where md5sum check time equals/close to zero, so project types with small files/folders such as EKG are shown.↩︎\nData comes in a continuous manner. The nsc-exporter normally takes a snapshot of new data and tranfer it. It then sleeps for 10 minutes before checking for new data. The slept times counted here are where next sleep is more than the sleeping interval (10 minutes) later, siginifying that new data comes right after the sleep. This is contrary to long idle time where no new data comes after the sleep.↩︎\nTo make sure files are transferred intact, s3cmd put checks the md5sum of the files. This takes time and is not reported as transfer time by s3cmd The md5sum check is done before starting the transfer. We estimate the md5sum check time by subtracting the transfer time from the time gap between two transfers. The md5sum check time is usually less than 10 minutes, so a gap larger than 10 minutes is not considered as md5sum check time.↩︎\nEffective transfer time is calculated as “absolute transfer time” + “sleep time between 2 transfers” + “md5sum check time”.↩︎"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Projects",
    "section": "",
    "text": "WGS Upscaling - IT & Bioinformatics Evaluation\n\n\n\n\n\nData transfer, Data storage, Bioinformatics pipeline capacity\n\n\n\n\n\n\nDec 12, 2023\n\n\nXuyang Yuan\n\n\n\n\n\n\nNo matching items"
  }
]